import { FunctionComponent, useState } from "react";
import { xssSelector } from "@utils/generator/xssgenerator";
import { Button } from "@components/buttons";
import { chromVersion, safariVersion } from "@constants/versions";
import * as Styled from "./style";

export const RandomXssPayload: FunctionComponent = () => {
  const [randomPayload, setRandomPayload] = useState<string>("NotInitialized");

  const generateRandomPayload = () => {
    const createdPayload = xssSelector(randomPayload);
    setRandomPayload(createdPayload);
  };

  return (
    <Styled.Container>
      <Button onClick={generateRandomPayload} txt="Click for XSS payload" />
      {randomPayload !== "NotInitialized" && (
        <Styled.VisibleContainer>
          <Styled.Title>Today&#39;s XSS</Styled.Title>
          <Styled.Payload>{randomPayload}</Styled.Payload>
          <Styled.Title>Test this payload</Styled.Title>
          {/* XSS 코드 실제 실행을 위해 */}
          {/* eslint-disable-next-line react/no-danger  */}
          <div dangerouslySetInnerHTML={{ __html: randomPayload }} />
          <Styled.VersionDescription>
            all of these payloads are tested on chrome {chromVersion} and safari {safariVersion}
          </Styled.VersionDescription>
        </Styled.VisibleContainer>
      )}
    </Styled.Container>
  );
};
